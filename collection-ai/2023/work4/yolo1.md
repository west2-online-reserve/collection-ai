# yoloV5模型构建/训练过程中需要注意的地方

## 构建

### yaml:

构建的每一层其实源码写的已经够明白了

在读取yolov5s.yaml文件时：

```
backbone:
  # [from, number, module, args]
[[-1, 1, Conv, [64, 6, 2, 2]],  # 0-P1/2
[-1, 1, Conv, [128, 3, 2]],  # 1-P2/4
[-1, 3, C3, [128]],



```

其实在args给参数的时候没给你input_size，这个赋值是从第二个（output_size）开始的，第一个input_size是赋值好的3，第二个input_size就是上一层的output_size了,有几层要concat拼接的要把input_size同时加上

### 数据增强：

一个是M = S @ T @ R，旋转缩放平移错切，说白了就是构建好矩阵相乘

一个是mosaic增广，就是把4个图拼成一个图

hsv好像没用上。。。

要注意label也要跟着改

### 构建数据集：

letterbox和mosaic不能同时开

### 自动锚框：

yolov5是用了kmeans聚类和遗传算法改的框

但是给的9个框的符合程度已经0.99了，估计就是拿预测voc的框拿当标准用了


## 训练

4090（24G）跑了200轮，100轮后发现过拟合严重，开了mosaic，在200轮时loss还能降，但是起伏很大，估计是数据集太小了，1.8G的数据集里，验证集都占一半了。

最好训练一半半把图画一个出来看，就知道置信度是哪里出问题了(就比如人的两个肩膀给忽略了所以才0.5)

在训练过程中，三个loss显示的特别小，因为展示出来的是有乘系数的，加起来的loss大是因为这个loss*batch_size（我一开始一直以为是标签不对应导致的，因为当时没看图就看P,R值，觉得结果很离谱）

训练结果看同文件的图
